<!DOCTYPE html>
<html lang="en" class="Individual-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Elliptic Curve Point Encoding</title>
<meta content="Vasilis Kalos" name="author">
<meta content="xml2rfc 3.17.4" name="generator">
<meta content="draft-point-encoding-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.17.4
    Python 3.11.1
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.2
    platformdirs 3.8.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 68.0.0
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-point-encoding.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">Elliptic Curve Point Encoding</td>
<td class="right">June 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Kalos</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">none</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-06-27" class="published">27 June 2023</time>
    </dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">V. Kalos</div>
<div class="org">MATTR</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Elliptic Curve Point Encoding</h1>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-preliminaries" class="internal xref">Preliminaries</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-curves-and-base-fields" class="internal xref">Curves and Base Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-coordinates-encoding" class="internal xref">Coordinates Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-coordinate-serialization" class="internal xref">Coordinate Serialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="auto internal xref">2.2.2</a>.  <a href="#name-coordinate-deserialization" class="internal xref">Coordinate Deserialization</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="auto internal xref">2.3</a>.  <a href="#name-point-sign" class="internal xref">Point Sign</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-metadata-bits" class="internal xref">Metadata Bits</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-serialization" class="internal xref">Serialization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-deserialization" class="internal xref">Deserialization</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-address" class="internal xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document specifies point serialization and deserialization procedures for Weierstrass curves. At a high level, the serialization operation is the following,<a href="#section-1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-1-2">
<li id="section-1-2.1">Each serialized point uses 3 extra metadata bits.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-1-2.2">If compression is used, the point's serialization will consist of the octet representation of it's <code>x</code> coordinate. In that case, during de-serialization, the <code>y</code> coordinate will be derived from <code>x</code>, using the metadata bits and the curve's equation.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-1-2.3">If compression is not used, the point's serialization will be comprised from the concatenation of the <code>x</code> and <code>y</code> coordinates octet representation.<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
        <li id="section-1-2.4">The metadata bits are appended at the start (i.e., in the most significant bits positions) of the point's serialization.<a href="#section-1-2.4" class="pilcrow">¶</a>
</li>
      </ol>
<div id="notation">
<section id="section-1.1">
        <h3 id="name-notation">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<ul class="compact">
<li class="compact" id="section-1.1-1.1">shift(array) -&gt; result: remove the first element (i.e., the element at index 0) from the array. Returns the array without its first element or INVALID, if the input array is empty.<a href="#section-1.1-1.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="preliminaries">
<section id="section-2">
      <h2 id="name-preliminaries">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-preliminaries" class="section-name selfRef">Preliminaries</a>
      </h2>
<div id="curves-and-base-fields">
<section id="section-2.1">
        <h3 id="name-curves-and-base-fields">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-curves-and-base-fields" class="section-name selfRef">Curves and Base Fields</a>
        </h3>
<p id="section-2.1-1">For pairing-based applications, there are often 2 distinct curves that are defined by the system's public parameters. Serialization and de-serialization of a point, should convey which of the 2 curves the point belongs to.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">Fp: Field of prime odd order <code>p</code>, comprising of scalar values between 0 and p - 1<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Fq: Extension field of order q = p^m. Elements are irreducible polynomials of order <code>m-1</code>, i.e., <code>s_(m-1) * x^(m-1) +  ...  s_2 * x^2 + s_1 * x + s_0</code>, where each <code>s_i</code> is an element of <code>Fp</code>. An element <code>s</code> of <code>Fq</code> will be represented by a the vector <code>s = (s_(m-1), ..., s_1, s_0)</code>.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.3">
            <p id="section-2.1-2.3.1">E: curve defined over <code>Fp</code>. A point of <code>E</code>, has its <code>x</code> and <code>y</code> coordinates on <code>Fp</code><a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">E': curve defined over <code>Fq</code>. A point of <code>E'</code>, has its <code>x</code> and <code>y</code> coordinates on <code>Fq</code><a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="coordinates-encoding">
<section id="section-2.2">
        <h3 id="name-coordinates-encoding">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-coordinates-encoding" class="section-name selfRef">Coordinates Encoding</a>
        </h3>
<div id="coordinate-serialization">
<section id="section-2.2.1">
          <h4 id="name-coordinate-serialization">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-coordinate-serialization" class="section-name selfRef">Coordinate Serialization</a>
          </h4>
<p id="section-2.2.1-1">Depending on the base field upon which a curve is defined, each coordinate can be represented either as a scalar <code>s</code>, or as a vector of scalars <code>s = (s_(m-1), ..., s_1, s_0)</code>. In the first case, the serialization of the coordinate will be the serialization of, i.e., <code>I2OSP(s)</code>. In the second case, we use the serialization defined in [Section 2.5] in <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>. More specifically, the serialization of that coordinate will be the concatenation <code>I2OSP(s_0) || ... || I2OSP(s_(m-1))</code>.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">We define the <code>to_octets(s)</code> operation, that will return a coordinate's <code>s</code> octet representation as defined above.<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="coordinate-deserialization">
<section id="section-2.2.2">
          <h4 id="name-coordinate-deserialization">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-coordinate-deserialization" class="section-name selfRef">Coordinate Deserialization</a>
          </h4>
<p id="section-2.2.2-1">Let <code>octs</code> be a coordinate's octet representation. To get the coordinate <code>s</code> from its encoding <code>octs</code>, the field that this coordinate belongs to needs to be determined. If the length of the <code>octs</code> representation is <code>ceil(log2(p)/8)</code>, and hence its a coordinate on <code>Fp</code>, then <code>s = OS2IP(octs)</code>. If the length of <code>octs</code> is <code>ceil(log2(q)/8)</code>, and hence its a coordinate on <code>Fq</code>, divide <code>octs</code> to <code>m</code> parts <code>s_(m-1), ..., s_0</code> of length <code>ceil(log2(p)/8)</code> each and set <code>s = (s_0, s_1, ..., s_(m-1))</code>. If the division is not exact, return an error.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">More specifically, we define the <code>from_octets</code> operation as follows,<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.2-3">
<pre>res = from_octets(octs)

Inputs:

- octs: octet string

Outputs:

- res: an element of either Fp or Fq, or INVALID

Procedure:

1.  if length(octs) = ceil(log2(p)/8):
2.      return OS2IP(octs)
3.  if length(octs) = ceil(log2(q)/8):
4.      bf = ceil(log2(p)/8)
5.      m = floor(length(octs) / bf)
6.      if m * bf != length(octs): return INVALID
7.      for i in (0, ..., m-1):
8.          r_i = s[(i * bf)..((i+1) * bf - 1)]
9.      return (OS2IP(r_0), OS2IP(r_1), ..., OS2IP(r_(m-1)))
10. else: return INVALID
</pre><a href="#section-2.2.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="point-sign">
<section id="section-2.3">
        <h3 id="name-point-sign">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-point-sign" class="section-name selfRef">Point Sign</a>
        </h3>
<p id="section-2.3-1">For any given, non-zero <code>x</code> coordinate, there are 2 points on the elliptic curve with that value as their <code>x</code> coordinate; <code>P = (x, y)</code> and <code>-P = (x, -y)</code> (where <code>-y = p - y mod p</code>). To define which of those points is the expected one during deserialization, the following functions are used, that will return a bit corresponding to the sign of the point's <code>y</code> coordinate.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">If the point <code>P</code> is on <code>E</code> (and hence it has coordinates in <code>Fp</code>):<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3-3">
<pre>sign_P_Fp(y) = 1 if y &gt; (p - 1)/2 else 0
</pre><a href="#section-2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3-4">If the point <code>P</code> is on <code>E'</code>, its coordinates will be in <code>Fq</code>. Note that if <code>y != 0</code>, the first non zero element of <code>y</code> and <code>-y</code> will be at the same position. Assume that position is <code>i</code>. Set the sign of <code>y</code> to the output of <code>sign_P_Fp(y[i])</code>. More specifically,<a href="#section-2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.3-5">
<pre>bit = sign_P_Fq(y)

Inputs:

- y: an element of Fq

Outputs:

- bit: either a 0 or 1 bit

Procedure:

1. for y_i in y:
2.     if y_i != 0:
3.         return sign_P_Fp(y_i)
4. return 0
</pre><a href="#section-2.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="metadata-bits">
<section id="section-3">
      <h2 id="name-metadata-bits">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-metadata-bits" class="section-name selfRef">Metadata Bits</a>
      </h2>
<p id="section-3-1">The 3 metadata bits are the following,<a href="#section-3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-3-2">
<li id="section-3-2.1">
          <code>C_bit</code>: 1 if point compression is used, 0 otherwise<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.2">
          <code>I_bit</code>: 1 if the point is the indemnity point of the curve (point on Infinity), 0 otherwise.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li id="section-3-2.3">
          <code>S_bit</code>: For point <code>P = (x, y)</code>, the <code>S_bit</code> will be the output of <code>sign_P_Fp(y)</code> if <code>P</code> is a point of <code>E</code>, or the output of <code>sign_P_Fq(y)</code> if <code>P</code> is a point of <code>E'</code>.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="serialization">
<section id="section-4">
      <h2 id="name-serialization">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-serialization" class="section-name selfRef">Serialization</a>
      </h2>
<p id="section-4-1">Let point <code>P = (x, y)</code>. Define <code>rb</code> to be the number of most significant bits that are always free (i.e., always set to 0) in the encoding of the <code>x</code> coordinate. To calculate <code>rb</code>, define <code>l</code> to be the length of the octets representation of <code>x</code>, i.e., let <code>l = ceil(log2(p)/8)</code> and,<a href="#section-4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-2">
<pre>rb = l * 8 - ceil(log2(p))
</pre><a href="#section-4-2" class="pilcrow">¶</a>
</div>
<p id="section-4-3">If there are at least 3 free bits in the encoding of <code>x</code> (i.e., if <code>rb &gt;= 3</code>), then all the metadata bits will be encoded using those bits. Otherwise, if there are not enough free bits (i.e., <code>rb &lt; 3</code>), one extra octet will be appended at the start of the point's octet string representation, to encode the metadata bits that did not "fit".<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Set the <code>C_bit</code>, <code>I_bit</code> and <code>S_bit</code> as in <a href="#metadata-bits" class="auto internal xref">Section 3</a>. Also set,<a href="#section-4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-5">
<pre>idx = 7 - rb
</pre><a href="#section-4-5" class="pilcrow">¶</a>
</div>
<p id="section-4-6">Let <code>metadata</code> to be 2 octets representing the number<a href="#section-4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-7">
<pre>C_bit * 2 ^ (idx + 3) + I_bit * 2 ^ (idx + 2) + S_bit * 2 ^ (idx + 1)
</pre><a href="#section-4-7" class="pilcrow">¶</a>
</div>
<p id="section-4-8">Note that if <code>rb &gt;= 3</code> the first octet of the <code>metadata</code> will be 0, and only the second octet will be used.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">Set <code>x_string = to_octets(x)</code> and <code>L = length(x_string)</code>, where the <code>to_octets</code> operation is defined in <a href="#coordinate-serialization" class="auto internal xref">Section 2.2.1</a>. Then do,<a href="#section-4-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-10.1">
          <p id="section-4-10.1.1">If <code>C_bit</code> is 0, meaning that compression will not be used, set <code>y_string = to_octets(y)</code>. Let <code>serialized</code> be an octet string of all 0s and length <code>2 * L + 1</code> (i.e., 1 octet longer than <code>x_string || y_string</code>). Set<a href="#section-4-10.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-10.1.2">
<pre>serialized[1..] = x_string || y_string
</pre><a href="#section-4-10.1.2" class="pilcrow">¶</a>
</div>
</li>
        <li class="normal" id="section-4-10.2">
          <p id="section-4-10.2.1">If <code>C_bit</code> is 1, meaning that compression is used, set <code>serialized</code> to be an octet string of all 0s and length <code>L + 1</code> (i.e., 1 octet longer than <code>x_string</code>). Set<a href="#section-4-10.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-10.2.2">
<pre>serialized[1..] = x_string
</pre><a href="#section-4-10.2.2" class="pilcrow">¶</a>
</div>
</li>
      </ul>
<p id="section-4-11">To encode the metadata, do,<a href="#section-4-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-12">
<pre>1. serialized[0] = metadata[0]
2. serialized[1] = serialized[1] XOR metadata[1]
</pre><a href="#section-4-12" class="pilcrow">¶</a>
</div>
<p id="section-4-13">If <code>serialized[0] == 0</code> it means that the extra octet was not needed to encode the metadata bits. In that case truncate the extra octet, i.e., set <code>serialized = shift(serialized)</code>, where <code>shift()</code> as defined in <a href="#notation" class="auto internal xref">Section 1.1</a>.<a href="#section-4-13" class="pilcrow">¶</a></p>
<p id="section-4-14">return <code>serialized</code> as the point serialization result.<a href="#section-4-14" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deserialization">
<section id="section-5">
      <h2 id="name-deserialization">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-deserialization" class="section-name selfRef">Deserialization</a>
      </h2>
<p id="section-5-1">Let <code>serialized</code> to be the serialization of a point <code>P</code>. Let <code>l = ceil(log2(p)/8)</code> and <code>rb</code> to be as in <a href="#serialization">Serialization</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If <code>length(compressed) = l + 1</code> it means that an extra octet was used to encode (some) of the metadata bits (i.e., 3 bits did not remain free in the <code>x</code> coordinate encoding, meaning that <code>rb &lt; 3</code>). Otherwise, all the metadata bits are encoded in the last octet of the <code>x</code> coordinate (i.e., <code>rb &gt; 3</code>).<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">Set <code>metadata</code> to be 2 octets set to all 0s. Do the following<a href="#section-5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-4">
<pre>1. if rb &lt; 3:
2.     metadata[0] = serialized[0]
3.     metadata[1] = serialized[1]

       // remove the first octet that was used only for metadata
4.     serialized = shift(serialized)
5. else:
6.     metadata[1] = serialized[0]
</pre><a href="#section-5-4" class="pilcrow">¶</a>
</div>
<p id="section-5-5">Note that at this point, the second <code>metadata</code> octet, will "contain" bits that are part of the encoding of <code>x</code>. More specifically, only the <code>rb</code> (which is possibly 0) of the <code>serialized[0]</code> octet are used for the metadata bits, and the rest are part of <code>x</code>'s octets representation. To separate the 2 do the following,<a href="#section-5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-6">
<pre>// Mask the rb most significant bits of the metadata
1. mask = 2 ^ (i + 3) + 2 ^ (i + 2) + 2 ^ (i + 1)

// keep the metadata bits
2. metadata[1] = metadata[1] AND mask

// remove the metadata bits from the encoding of x
3. serialized[0] = serialized[0] AND !mask
</pre><a href="#section-5-6" class="pilcrow">¶</a>
</div>
<p id="section-5-7">To get the actual metadata bits, set <code>idx = 7 - rb</code> and find <code>C_bit</code>, <code>I_bit</code> and  <code>S_bit</code> such that<a href="#section-5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-8">
<pre>metadata =
 = C_bit * 2 ^ (idx + 3) + I_bit * 2 ^ (idx + 2) + S_bit * 2 ^ (idx + 1)
</pre><a href="#section-5-8" class="pilcrow">¶</a>
</div>
<p id="section-5-9"><strong>Note</strong> this can be done by moving those bits on the "start" of the metadata octets by doing <code>metadata &gt;&gt; 8 - rb</code>, and then setting  <code>C_bit</code>, <code>I_bit</code> and  <code>S_bit</code> to be the 3 least significant bits of <code>metadata[1]</code>. If any other bit in metadata is set, ABORT decoding.<a href="#section-5-9" class="pilcrow">¶</a></p>
<p id="section-5-10">To deserialize the point do,<a href="#section-5-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-5-11">
<li id="section-5-11.1">
          <p id="section-5-11.1.1">Determine the curve of the point based on the length of the <code>serialized</code> octet string:<a href="#section-5-11.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-11.1.2.1">If <code>length(serialized) = ceil(log2(p)/8)</code> or <code>length(serialized) = 2 * ceil(log2(p)/8)</code>, then the curve of the point was <code>E</code>.<a href="#section-5-11.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5-11.1.2.2">If <code>length(serialized) = ceil(log2(q)/8)</code> or <code>length(serialized) = 2 * ceil(log2(q)/8)</code>, hen the curve of the point was <code>E'</code>.<a href="#section-5-11.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5-11.1.2.3">In any other case, ABORT decoding.<a href="#section-5-11.1.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-5-11.2">If <code>I_bit</code> is set, then if <code>serialized</code> is comprised from all 0s, return the identity point of the curve determined in step 1. If <code>serialized</code> is not all 0s, ABORT.<a href="#section-5-11.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-11.3">
          <p id="section-5-11.3.1">If <code>C_bit</code> is 0, meaning that compression is not used, divide <code>serialized</code> into 2 octet string <code>s_0</code> and <code>s_1</code> of equal length so that <code>serialized = s_0 || s_1</code>. Set <code>x = from_octets(s_0)</code> and <code>y = from_octets(s_1)</code>.<a href="#section-5-11.3.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-11.3.2.1">Set <code>P = (x, y)</code>. If <code>P</code> is a point of the curve determined in step 1, return <code>P</code>. Otherwise, ABORT decoding.<a href="#section-5-11.3.2.1" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li id="section-5-11.4">
          <p id="section-5-11.4.1">If <code>C_bit</code> is 1, do the following,<a href="#section-5-11.4.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-11.4.2.1">Set <code>x = from_octets(serialized)</code>, where the <code>from_octets()</code> as defined in <a href="#coordinate-deserialization" class="auto internal xref">Section 2.2.2</a>.<a href="#section-5-11.4.2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-5-11.4.2.2">
              <p id="section-5-11.4.2.2.1">Solve the equation of the curve defined in step 1 to determine the <code>y</code> coordinate. If <code>y = 0</code> and <code>S_bit = 1</code> ABORT. Otherwise do the following,<a href="#section-5-11.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-5-11.4.2.2.2.1">If the curve determined in step 1 was <code>E</code>, then if <code>S_bit = sign_P_Fp(y)</code> return <code>P = (x, y)</code>. Otherwise, return <code>P = (x, -y)</code>.<a href="#section-5-11.4.2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="section-5-11.4.2.2.2.2">If the curve determined in step 1 was <code>E'</code>, then if <code>S_bit = sign_P_Fq(y)</code> return <code>P = (x, y)</code>. Otherwise, return <code>P = (x, -y)</code>.<a href="#section-5-11.4.2.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
</li>
      </ol>
</section>
</div>
<section id="section-6">
      <h2 id="name-normative-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.irtf-cfrg-pairing-friendly-curves">[I-D.irtf-cfrg-pairing-friendly-curves]</dt>
    <dd>
<span class="refAuthor">Sakemi, Y.</span>, <span class="refAuthor">Kobayashi, T.</span>, <span class="refAuthor">Saito, T.</span>, and <span class="refAuthor">R. S. Wahby</span>, <span class="refTitle">"Pairing-Friendly Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-pairing-friendly-curves-11</span>, <time datetime="2022-11-06" class="refDate">6 November 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-pairing-friendly-curves-11">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-pairing-friendly-curves-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vasilis Kalos</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vasilis.kalos@mattr.global" class="email">vasilis.kalos@mattr.global</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
